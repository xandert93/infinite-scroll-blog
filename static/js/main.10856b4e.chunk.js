(this["webpackJsonpinfinite-scroll-blog"]=this["webpackJsonpinfinite-scroll-blog"]||[]).push([[0],{26:function(e,t,c){},46:function(e,t,c){"use strict";c.r(t);var s=c(0),n=c(1),r=c(18),a=c.n(r),o=(c(26),c(4)),i={isLoading:!0,fetchedPosts:[],filteredPosts:[],errMsg:null},l=Object(n.createContext)(),u=function(e){var t=e.title,c=e.body,r=e.postNum,a=e.observePost,i=Object(n.useState)(!1),l=Object(o.a)(i,2),u=l[0],j=l[1],b=Object(n.useRef)(),d=Object(n.useCallback)((function(e){e&&(b.current=new IntersectionObserver(O),b.current.observe(e))}),[]),O=function(e){Object(o.a)(e,1)[0].isIntersecting&&(j(!0),b.current.disconnect())};return Object(s.jsxs)("div",{ref:a,className:"post ".concat(u?"":"post--hidden"),children:[Object(s.jsx)("div",{ref:d,className:"post__id",children:r}),Object(s.jsx)("div",{className:"post__title",children:t}),Object(s.jsx)("div",{className:"post__body",children:c})]})},j=function(e){var t=e.inputRef,c=Object(n.useContext)(l),r=c.filteredPosts,a=c.setLoading,i=c.fetchPosts;console.log(r);var j=Object(n.useRef)(),b=Object(n.useCallback)((function(e){e&&(j.current=new IntersectionObserver(d,{threshold:1}),[0,100].includes(r.length)||t.current.value||j.current.observe(e))}),[r]),d=function(e){var c=Object(o.a)(e,1)[0];c.isIntersecting&&!t.current.value&&(a(),i(),j.current.unobserve(c.target))};return Object(s.jsx)("div",{className:"posts-container",children:r.map((function(e){var t=e.id,c=e.title,n=e.body;return Object(s.jsx)(u,{postNum:t,title:c,body:n,observePost:t===r.length?b:null},t)}))})},b=function(){return Object(s.jsxs)("footer",{className:"footer",title:"Visit GitHub page",children:["\xa9"," ",Object(s.jsx)("a",{className:"link--github",href:"https://github.com/xandert93",target:"_blank",rel:"noopener noreferrer",children:"xandert.93"})]})},d=function(){return Object(s.jsx)("h1",{className:"header",children:"Infinite Scroll Blog"})},O=function(){return Object(s.jsxs)("div",{className:"loader",children:[Object(s.jsx)("div",{className:"circle"}),Object(s.jsx)("div",{className:"circle"}),Object(s.jsx)("div",{className:"circle"})]})},f=function(e){var t=e.inputRef,c=Object(n.useContext)(l),r=c.filterPosts,a=c.isLoading,i=Object(n.useState)(""),u=Object(o.a)(i,2),j=u[0],b=u[1];return Object(n.useEffect)((function(){return r(j)}),[j]),Object(s.jsx)("div",{className:"search-input-container",children:Object(s.jsx)("input",{ref:t,value:j,onChange:function(e){return b(e.target.value)},className:"search-input",placeholder:"Filter results...",style:{pointerEvents:"".concat(a?"none":"")}})})},h=function(){var e=Object(n.useContext)(l),t=e.isLoading,c=e.filteredPosts,r=e.fetchPosts,a=Object(n.useRef)();return Object(n.useEffect)(r,[]),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(d,{}),Object(s.jsx)(f,{inputRef:a}),0===c.length&&t&&Object(s.jsx)(O,{}),c.length>0&&Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(j,{inputRef:a}),t&&Object(s.jsx)(O,{})]}),Object(s.jsx)(b,{})]})},p=c(3),v=c(9),x=c.n(v),g=c(19),m=c(6),P="SET_LOADING",y="GET_POSTS",N="FILTER_POSTS",_="SET_ERR_MSG",k=function(e,t){switch(t.type){case P:return Object(p.a)(Object(p.a)({},e),{},{isLoading:!0});case y:return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,fetchedPosts:[].concat(Object(m.a)(e.fetchedPosts),Object(m.a)(t.payload)),filteredPosts:[].concat(Object(m.a)(e.fetchedPosts),Object(m.a)(t.payload))});case N:return Object(p.a)(Object(p.a)({},e),{},{filteredPosts:e.fetchedPosts.filter((function(e){var c=e.title,s=e.body;return c.includes(t.payload)||s.includes(t.payload)}))});case _:return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,fetchedPosts:[],errMsg:t.payload});default:return e}},C=c(20),L=c.n(C),R=1,S=function(e){var t=e.children,c=Object(n.useReducer)(k,i),r=Object(o.a)(c,2),a=r[0],u=r[1],j=a.fetchedPosts,b=Object(n.useCallback)(Object(g.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.a.get("https://jsonplaceholder.typicode.com/posts?_limit=10&_page="+R);case 3:t=e.sent,setTimeout((function(){u({type:y,payload:t.data}),R++}),0===j.length?3e3:2e3),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),u({type:_,payload:"There was an error: ".concat(e.t0.message,".")});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[]),d=Object(n.useCallback)((function(){return u({type:P})}),[]),O=Object(n.useCallback)((function(e){return u({type:N,payload:e.toLowerCase()})}),[]);return Object(s.jsx)(l.Provider,{value:Object(p.a)(Object(p.a)({},a),{},{fetchPosts:b,setLoading:d,filterPosts:O}),children:t})};a.a.render(Object(s.jsx)(S,{children:Object(s.jsx)(h,{})}),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.10856b4e.chunk.js.map