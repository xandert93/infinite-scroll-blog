(this["webpackJsonpinfinite-scroll-blog"]=this["webpackJsonpinfinite-scroll-blog"]||[]).push([[0],{26:function(e,t,s){},46:function(e,t,s){"use strict";s.r(t);var c=s(0),n=s(1),r=s(18),a=s.n(r),o=(s(26),s(4)),i={urlPage:1,baseUrl:"https://jsonplaceholder.typicode.com/posts?_limit=4&_page=1",isLoading:!0,fetchedPosts:[],filteredPosts:[],errMsg:null},l=Object(n.createContext)(),u=function(e){var t=e.title,s=e.body,n=e.postNum,r=e.observePost;return Object(c.jsxs)("div",{ref:r,className:"post",children:[Object(c.jsx)("div",{className:"post__id",children:n}),Object(c.jsx)("div",{className:"post__title",children:t}),Object(c.jsx)("div",{className:"post__body",children:s})]})},j=function(e){var t=e.inputRef,s=Object(n.useContext)(l),r=s.filteredPosts,a=s.setLoading,i=s.fetchPosts,j=Object(n.useRef)(),d=Object(n.useCallback)((function(e){e&&(j.current=new IntersectionObserver(b,{threshold:1}),![0,100].includes(r.length)&&!t.current.value&&j.current.observe(e))}),[r]),b=function(e){var t=Object(o.a)(e,1)[0];t.isIntersecting&&(a(),i(),j.current.unobserve(t.target))};return Object(c.jsx)("div",{className:"posts-container",children:r.map((function(e){var t=e.id,s=e.title,n=e.body;return Object(c.jsx)(u,{postNum:t,title:s,body:n,observePost:t===r.length?d:null},t)}))})},d=function(){return Object(c.jsxs)("footer",{className:"footer",title:"Visit GitHub page",children:["\xa9"," ",Object(c.jsx)("a",{className:"link--github",href:"https://github.com/xandert93",target:"_blank",rel:"noopener noreferrer",children:"xandert.93"})]})},b=function(){return Object(c.jsx)("h1",{className:"header",children:"Infinite Scroll Blog"})},f=function(){return Object(c.jsxs)("div",{className:"loader",children:[Object(c.jsx)("div",{className:"circle"}),Object(c.jsx)("div",{className:"circle"}),Object(c.jsx)("div",{className:"circle"})]})},O=function(e){var t=e.inputRef,s=Object(n.useContext)(l),r=s.filterPosts,a=s.isLoading,i=Object(n.useState)(""),u=Object(o.a)(i,2),j=u[0],d=u[1];return Object(n.useEffect)((function(){return r(j)}),[j]),Object(c.jsx)("div",{className:"search-input-container",children:Object(c.jsx)("input",{ref:t,value:j,onChange:function(e){return d(e.target.value)},className:"search-input",placeholder:"Filter results...",style:{pointerEvents:"".concat(a?"none":"")}})})},p=function(){var e=Object(n.useContext)(l),t=e.isLoading,s=e.urlPage,r=e.filteredPosts,a=e.fetchPosts,o=Object(n.useRef)();return Object(n.useEffect)(a,[]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(b,{}),Object(c.jsx)(O,{inputRef:o}),1===s&&Object(c.jsx)(f,{}),r.length>0&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(j,{inputRef:o}),t&&Object(c.jsx)(f,{})]}),Object(c.jsx)(d,{})]})},h=s(3),g=s(9),v=s.n(g),x=s(19),m=s(6),P="SET_LOADING",y="GET_POSTS",N="FILTER_POSTS",_="SET_ERR_MSG",L=function(e,t){switch(t.type){case P:return Object(h.a)(Object(h.a)({},e),{},{isLoading:!0});case y:return Object(h.a)(Object(h.a)({},e),{},{isLoading:!1,fetchedPosts:[].concat(Object(m.a)(e.fetchedPosts),Object(m.a)(t.payload)),filteredPosts:[].concat(Object(m.a)(e.fetchedPosts),Object(m.a)(t.payload)),urlPage:e.urlPage+1,baseUrl:"https://jsonplaceholder.typicode.com/posts?_limit=4&_page=".concat(e.urlPage+1)});case N:return Object(h.a)(Object(h.a)({},e),{},{filteredPosts:e.fetchedPosts.filter((function(e){var s=e.title,c=e.body;return s.includes(t.payload)||c.includes(t.payload)}))});case _:return Object(h.a)(Object(h.a)({},e),{},{isLoading:!1,fetchedPosts:[],errMsg:t.payload});default:return e}},R=s(20),E=s.n(R),S=function(e){var t=e.children,s=Object(n.useReducer)(L,i),r=Object(o.a)(s,2),a=r[0],u=r[1],j=a.baseUrl,d=a.fetchedPosts,b=function(){var e=Object(x.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.a.get(j);case 3:t=e.sent,setTimeout((function(){return u({type:y,payload:t.data})}),0===d.length?3e3:2e3),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),u({type:_,payload:"There was an error: ".concat(e.t0.message,".")});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(c.jsx)(l.Provider,{value:Object(h.a)(Object(h.a)({},a),{},{fetchPosts:b,setLoading:function(){return u({type:P})},filterPosts:function(e){return u({type:N,payload:e.toLowerCase()})}}),children:t})};a.a.render(Object(c.jsx)(S,{children:Object(c.jsx)(p,{})}),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.d306ff5f.chunk.js.map